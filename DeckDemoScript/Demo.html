<!DOCTYPE html>
<html xmlns:m="http://schemas.microsoft.com/office/2004/12/omml" xmlns:v="urn:schemas-microsoft-com:vml" xmlns:o="urn:schemas-microsoft-com:office:office">
<head>
<meta charset="windows-1251" />
<title>Markdown Preview</title>
<style>
body{font-family:helvetica, arial, freesans, clean, sans-serif;color:#333;line-height:1.6;font-size:14px}.markdown-body{line-height:1.6;font-size:14px}.markdown-body > *:first-child{margin-top:0 !important}.markdown-body > *:last-child{margin-bottom:0 !important}.markdown-body a.absent{color:#c00}.markdown-body h1{font-weight:700;-webkit-font-smoothing:antialiased;color:#000;font-size:28px;margin:20px 0 10px;padding:0}.markdown-body h2{font-weight:700;-webkit-font-smoothing:antialiased;color:#000;font-size:24px;border-bottom-color:#ccc;border-bottom-width:1px;border-bottom-style:solid;margin:20px 0 10px;padding:0}.markdown-body h3{font-weight:700;-webkit-font-smoothing:antialiased;font-size:18px;margin:20px 0 10px;padding:0}.markdown-body h4{font-weight:700;-webkit-font-smoothing:antialiased;font-size:16px;margin:20px 0 10px;padding:0}.markdown-body h5{font-weight:700;-webkit-font-smoothing:antialiased;font-size:14px;margin:20px 0 10px;padding:0}.markdown-body h6{font-weight:700;-webkit-font-smoothing:antialiased;color:#777;font-size:14px;margin:20px 0 10px;padding:0}.markdown-body blockquote{color:#777;border-left-color:#ddd;border-left-width:4px;border-left-style:solid;margin:15px 0;padding:0 15px}.markdown-body dl{margin:15px 0;padding:0}.markdown-body table{border-collapse:collapse;margin:15px 0;padding:0}.markdown-body pre{border-radius:3px;border:1px solid #ccc;line-height:19px;overflow:auto;font-size:13px;background-color:#f8f8f8;margin:15px 0;padding:6px 10px}.markdown-body li p.first{display:inline-block}.markdown-body dl dt{font-size:14px;font-style:italic;font-weight:700;margin:15px 0 5px;padding:0}.markdown-body dl dt:first-child{padding:0}.markdown-body dl dd{margin:0 0 15px;padding:0 15px}.markdown-body table tr{border-top-color:#ccc;border-top-width:1px;border-top-style:solid;background-color:#fff;margin:0;padding:0}.markdown-body table tr:nth-child(2n){background-color:#f8f8f8}.markdown-body img{max-width:100%}.markdown-body span.frame{overflow:hidden;display:block}.markdown-body span.frame > span{border:1px solid #ddd;width:auto;overflow:hidden;float:left;display:block;margin:13px 0 0;padding:7px}.markdown-body span.frame span img{float:left;display:block}.markdown-body span.frame span span{color:#333;clear:both;display:block;padding:5px 0 0}.markdown-body span.align-center > span{text-align:center;overflow:hidden;display:block;margin:13px auto 0}.markdown-body span.align-center span img{text-align:center;margin:0 auto}.markdown-body span.align-right > span{text-align:right;overflow:hidden;display:block;margin:13px 0 0}.markdown-body span.align-right span img{text-align:right;margin:0}.markdown-body span.float-left{overflow:hidden;margin-right:13px;float:left;display:block}.markdown-body span.float-left span{margin:13px 0 0}.markdown-body span.float-right{overflow:hidden;margin-left:13px;float:right;display:block}.markdown-body span.float-right > span{text-align:right;overflow:hidden;display:block;margin:13px auto 0}.markdown-body pre > code{border:currentColor;white-space:pre;margin:0;padding:0}.markdown-body .highlight pre{border-radius:3px;border:1px solid #ccc;line-height:19px;overflow:auto;font-size:13px;background-color:#f8f8f8;padding:6px 10px}.markdown-body p,.markdown-body li{margin:15px 0}.markdown-body ul,.markdown-body ol{padding-left:30px;margin:15px 0}.markdown-body > h2:first-child,.markdown-body > h1:first-child,.markdown-body > h1:first-child + h2{border:0 currentColor;padding-top:0;margin-top:0}.markdown-body > h3:first-child,.markdown-body > h4:first-child,.markdown-body > h5:first-child,.markdown-body > h6:first-child{padding-top:0;margin-top:0}.markdown-body h1 + p,.markdown-body h2 + p,.markdown-body h3 + p,.markdown-body h4 + p,.markdown-body h5 + p,.markdown-body h6 + p,.markdown-body ul li > :first-child,.markdown-body ol li > :first-child,.markdown-body dl dt > :first-child,.markdown-body dl dd > :first-child,.markdown-body blockquote > :first-child,.markdown-body table tr th > :first-child,.markdown-body table tr td > :first-child{margin-top:0}.markdown-body ul li > :last-child,.markdown-body ol li > :last-child,.markdown-body dl dt > :last-child,.markdown-body dl dd > :last-child,.markdown-body blockquote > :last-child,.markdown-body table tr th > :last-child,.markdown-body table tr td > :last-child{margin-bottom:0}.markdown-body table tr th,.markdown-body table tr td{border:1px solid #ccc;text-align:left;margin:0;padding:6px 13px}.markdown-body span.align-center,.markdown-body span.align-right{overflow:hidden;clear:both;display:block}.markdown-body code,.markdown-body tt{border-radius:3px;border:1px solid #eaeaea;white-space:nowrap;background-color:#f8f8f8;margin:0 2px;padding:0 5px}.markdown-body pre code,.markdown-body pre tt{border:currentColor;background-color:transparent}span.codelanguage{display:none}
.style1 {
	color: blue;
	text-decoration: underline;
}
</style>
</head>
<body>
<div class="markdown-body">
<p><a name="title"></a></p>

<h1 id="Demo_Script_Building_Windows_Store_Applications_with_Windows_Azure_Mobile_Services">
<a name="title0"></a><b>
<span lang="RU" style="font-size: 21.0pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: black; mso-font-kerning: 18.0pt; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
Демонстрационный сценарий: создание приложений для магазина Windows Store с 
помощью служб Windows Azure Mobile Services</span></b></h1>

<hr>

<p><a name="Overview"></a></p>

<h2 id="Overview"><b>
<span lang="RU" style="font-size: 18.0pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: black; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
Общие сведения</span></b></h2>

<p>
<span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
Этот сценарий служит для демонстрации возможностей Visual Studio 2012 и Windows 
Azure Mobile Services, позволяющих добавлять функции хранилища структурированных 
данных, принудительного отправления уведомлений и интегрированной проверки 
подлинности к приложению Windows Store.</span></p>
<blockquote>
<p><strong>
<span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #777777; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
Примечание. </span></strong>
<span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #777777; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
Этот демонстрационный сценарий можно использовать для презентации Windows Azure 
Mobile Services. Пошаговое руководство со снимками экрана содержится в разделе 
«Практическое занятие» учебного комплекта Windows Azure.</span></p>
</blockquote>
<p><a name="technologies"></a></p>

<h3 id="Key_Technologies"><b>
<span lang="RU" style="font-size: 13.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
Ключевые технологии</span></b></h3>

<ul>
<li>
<span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
Подписка на Windows Azure — </span>
<span lang="RU" style="font-size: 12.0pt; font-family: &quot;Times New Roman&quot;,&quot;serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
<a href="http://bit.ly/WindowsAzureFreeTrial">
<span style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;">
регистрация</span></a> </span>
<span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #404040; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
для получения бесплатной версии.</span></li>
<li>
<span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
Подписка дает возможность предварительного ознакомления с приложением Windows 
Azure Mobile Services.</span></li>
<li>
<span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
Пакет</span><span style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: EN-US; mso-fareast-language: EN-US; mso-bidi-language: AR-SA"> 
SDK </span>
<span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
клиента</span><span style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: EN-US; mso-fareast-language: EN-US; mso-bidi-language: AR-SA"> 
Windows Azure Mobile Services.</span></li>
<li>
<span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
Visual Studio 2012.</span></li>
</ul>

<p><a name="setup-and-configuration"></a></p>

<h3 id="Setup_and_Configuration"><b>
<span lang="RU" style="font-size: 13.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
Установка и настройка</span></b></h3>

<p>
<span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
Необходимо настроить среду для выполнения этого демонстрационного сценария.</span></p>

<ol>
<li><p>
<span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
Скачайте и установите Windows 8.</span></p></li>
<li><p>
<span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
Скачайте и установите Visual Studio 2012.</span></p></li>
<li><p>
<span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
Скачайте и установите пакет SDK для Windows Azure Mobile Services.</span></p></li>
<li><p><strong>
<span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
Фрагменты кода</span></strong><span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">, 
которые можно добавлять и использовать в Visual Studio 2012, приводятся здесь: 
/Source/ClientSnippets.</span></p></li>
</ol>

<p><a name="Demo 1: Creating your first Mobile Service"></a></p>

<h2 id="Demo_1_Creating_your_first_Mobile_Service"><b>
<span lang="RU" style="font-size: 18.0pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: black; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
Демонстрация 1: создание первой службы Mobile Service</span></b></h2>

<p>
<span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
Цель этого примера — использовать функцию быстрого запуска на портале для 
демонстрации возможностей хранения структурированных данных Windows Azure Mobile 
Services. Демонстрация push-уведомлений предназначена для показа методики 
добавления кода в серверную и клиентскую часть приложения и использования API 
для быстрого запуска.</span></p>

<p><a name="create-a-new-mobile-service"></a></p>

<h3 id="Create_a_new_mobile_service"><b>
<span lang="RU" style="font-size: 13.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
Создание новой мобильной службы</span></b></h3>

<p>
<span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
Для создания новой мобильной службы выполните следующие действия:</span></p>

<ol>
<li><p>
<span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
Войдите в </span>
<span lang="RU" style="font-size: 12.0pt; font-family: &quot;Times New Roman&quot;,&quot;serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
<a href="https://manage.windowsazure.com">
<span style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;">
Портал управления Windows Azure</span></a></span><span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA"> 
и откройте раздел Mobile Services (Мобильные службы).</span></p></li>
<li><p>
<span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
Нажмите кнопку <strong>
<span style="font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;">+New</span></strong> 
(+Новая), а затем <strong>
<span style="font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;">Mobile 
Service</span></strong> (Мобильная служба), <strong>
<span style="font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;">Create</span></strong> 
(Создать). </span> </p></li>
<li><p>
<span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
В диалоговом окне <strong>
<span style="font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;">Create a 
Mobile Service</span></strong> (Создание мобильной службы) укажите уникальный 
субдомен в поле <strong>
<span style="font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;">URL</span></strong>. 
После проверки уникальности субдомена переходите к следующему этапу.</span></p></li>
<li><p>
<span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
Укажите, использовать ли существующую базу данных или создать новую. Выберите 
регион. <strong>
<span style="font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;">
Пояснение:</span></strong> если вы выбрали существующую базу данных, то Windows 
Azure Mobile Services отсортирует клиентов мобильной службы по схеме.</span></p></li>
<li><p>
<span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
Настройте остальные параметры базы данных при помощи мастера создания мобильной 
службы</span></p></li>
</ol>

<p>
<span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
Вы завершили создание новой мобильной службы для использования мобильными 
приложениями.</span></p>

<p><a name="create-a-new-app"></a></p>

<h3 id="Create_a_new_app"><b>
<span lang="RU" style="font-size: 13.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
Создание нового приложения</span></b></h3>

<p>
<span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
Создав мобильную службу, вы можете следовать краткому руководству Портала 
управления, чтобы создать новое приложение Windows Store (или изменить 
существующее), а затем подключить его к мобильной службе.</span></p>

<ol>
<li><p>
<span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
Дождитесь обновления статуса мобильной службы на вкладке <strong>
<span style="font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;">Mobile 
Services</span></strong> Портала управления до состояния <strong>
<span style="font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;">Ready 
(Готово)</span></strong>. Щелкните имя мобильной службы, чтобы перейти к этой 
службе.</span></p></li>
<li><p>
<span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
Чтобы открыть страницу быстрого запуска служб Mobile Services, нажмите</span><span lang="RU" style="font-size: 12.0pt; font-family: &quot;Times New Roman&quot;,&quot;serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA"><!--[if gte vml 1]><v:shapetype id="_x0000_t75"
 coordsize="21600,21600" o:spt="75" o:preferrelative="t" path="m@4@5l@4@11@9@11@9@5xe"
 filled="f" stroked="f">
 <v:stroke joinstyle="miter"/>
 <v:formulas>
  <v:f eqn="if lineDrawn pixelLineWidth 0"/>
  <v:f eqn="sum @0 1 0"/>
  <v:f eqn="sum 0 0 @1"/>
  <v:f eqn="prod @2 1 2"/>
  <v:f eqn="prod @3 21600 pixelWidth"/>
  <v:f eqn="prod @3 21600 pixelHeight"/>
  <v:f eqn="sum @0 0 1"/>
  <v:f eqn="prod @6 1 2"/>
  <v:f eqn="prod @7 21600 pixelWidth"/>
  <v:f eqn="sum @8 21600 0"/>
  <v:f eqn="prod @7 21600 pixelHeight"/>
  <v:f eqn="sum @10 21600 0"/>
 </v:formulas>
 <v:path o:extrusionok="f" gradientshapeok="t" o:connecttype="rect"/>
 <o:lock v:ext="edit" aspectratio="t"/>
</v:shapetype><v:shape id="_x0000_i1025" type="#_x0000_t75" style='width:16.5pt;
 height:12.75pt'>
 <v:imagedata src="file:///C:\Users\EC7E2~1.MAL\AppData\Local\Temp\3\msohtmlclip1\01\clip_image001.png"
  o:title="image-16"/>
</v:shape><![endif]--><![if !vml]>
<img width="22" height="17" src="clip_image002.png" v:shapes="_x0000_i1025"><![endif]></span><span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">.</span></p></li>
<li><p>
<span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
Выберите</span><span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: EN-US; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
</span>
<span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
пункт</span><span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: EN-US; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
</span><strong>
<span style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: EN-US; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
Create a new Windows 8 application</span></strong><span style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: EN-US; mso-fareast-language: EN-US; mso-bidi-language: AR-SA"> 
(</span><span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">Создать</span><span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: EN-US; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
</span>
<span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
новое</span><span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: EN-US; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
</span>
<span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
приложение</span><span style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: EN-US; mso-fareast-language: EN-US; mso-bidi-language: AR-SA"> 
Windows 8.</span></p>

<ul>
<li>
<span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
Чтобы выполнить шаг <strong>
<span style="font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;">Get the 
tools</span></strong> (Получить инструменты), установите пакет SDK для служб 
Mobile Services (если вы не сделали этого ранее). Пакет SDK для Windows Azure 
Mobile Services содержит клиентский интерфейс API, который можно использовать с 
приложениями Windows Store, написанными на языках Visual C++, XAML/C#/VB и 
HTML/JS.</span></li>
<li>
<span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
Выберите пункт <strong>
<span style="font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;">Create 
Todoitem table</span></strong> (Создать таблицу Todoitem (Элементы задач)). 
После этого будет создана таблица для начального проекта.</span></li>
<li>
<span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
На этапе скачивания и запуска приложения выберите язык (в данном случае <strong>
<span style="font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;">C#)</span></strong> 
и щелкните <strong>
<span style="font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;">Download</span></strong> 
(Скачать).</span></li>
</ul></li>
</ol>

<p>
<span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
Произойдет скачивание проекта для примера приложения <em>
<span style="font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;">To do 
list</span></em>, которое подключается к вашей мобильной службе. Сохраните 
сжатый файл проекта на локальном компьютере; запомните, где вы сохранили файл.</span></p>
<blockquote>
<p><strong>
<span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #777777; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
Пояснение:</span></strong><span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #777777; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA"> 
можно вручную добавлять дополнительные таблицы; для этого выберите вкладку Data 
(Данные), затем нажмите кнопку Create (Создать). Мы вернемся к вопросу 
добавления таблиц с помощью вкладки Data, когда будем рассматривать демонстрацию 
push-уведомлений. </span> </p>
</blockquote>
<p><a name="run-your-app"></a></p>

<h3 id="Run_your_app"><b>
<span lang="RU" style="font-size: 13.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
Запустите приложение</span></b></h3>

<p>
<span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
Последний раздел этого учебного пособия — запуск и изучение нового приложения 
Windows Store.</span></p>

<ol>
<li><p>
<span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
Перейдите в папку, в которой вы сохранили сжатый файл проекта, распакуйте файлы 
на диск вашего компьютера и откройте файл решения в Visual Studio 2012 Express 
для Windows 8.</span></p></li>
<li><p>
<span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
Нажмите клавишу <strong>
<span style="font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;">F5</span></strong>, 
чтобы перестроить проект и запустить приложение.</span></p></li>
<li><p>
<span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
В приложении введите значащий текст, например <em>
<span style="font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;">Complete 
the demo (Завершить демонстрацию)</span></em> в текстовое поле <strong>
<span style="font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;">Insert a 
TodoItem</span></strong> (Вставить задачу) и нажмите кнопку <strong>
<span style="font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;">Save</span></strong> 
(Сохранить).</span></p>

<p><strong>
<span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
Пояснение:</span></strong><span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA"> 
объясните аудитории, что при этом в новую мобильную службу, размещенную в 
Windows Azure, направляется запрос POST. Данные из запроса вставляются в таблицу 
TodoItem (Элементы задач). Элементы, сохраняемые в таблице, возвращаются 
мобильной службой, а данные отображаются во втором столбце приложения.</span></p></li>
<li><p>
<span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
В Портале управления выберите вкладку <strong>
<span style="font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;">Data</span></strong>, 
а затем — таблицу <strong>
<span style="font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;">
TodoItems</span></strong>; посмотрите, какие данные были успешно сохранены.</span></p></li>
</ol>

<p><a name="Explore-your-app-code"></a></p>

<h3 id="Explore_your_app_code"><b>
<span lang="RU" style="font-size: 13.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
Проверьте код приложения</span></b></h3>

<p>
<span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
На этом этапе мы рассмотрим код приложения <em>
<span style="font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;">To do 
list</span></em>, чтобы убедиться, насколько просто пакет SDK клиента Windows 
Azure Mobile Services позволяет приложению взаимодействовать с Windows Azure 
Mobile Services.</span></p>

<ol>
<li><p>
<span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
Вернитесь к скачанному ранее приложению To do list в Visual Studio 2012.</span></p></li>
<li><p>
<span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
В обозревателе решений разверните <strong>
<span style="font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;">папку 
ссылок</span></strong> и найдите ссылку пакета SDK клиента Windows Azure Mobile 
Services. <strong>
<span style="font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;">
Пояснение:</span></strong> в пакет SDK клиента Windows Azure Mobile Services 
можно также добавить ссылки из любого приложения Windows Store.</span></p></li>
<li><p>
<span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
Откройте App.xaml.cs и продемонстрируйте класс MobileServiceClient. Этот 
ключевой класс, реализованный пакетом SDK клиента, позволяет вашему приложению 
взаимодействовать с Windows Azure Mobile Services. Первый параметр конструктора 
— это конечная точка службы Mobile Service, а второй — это ключ приложения для 
службы Mobile Service.</span></p>

<span class="codelanguage">C#</span><pre><code class="C#"><span style="color:#0000FF">public</span> <span style="color:#0000FF">static</span> MobileServiceClient MobileService 
        = <span style="color:#0000FF">new</span> MobileServiceClient( 
            <span style="color:#8B0000">&quot;https://cloudnick.azure-mobile.net/&quot;</span>
            ,<span style="color:#8B0000">&quot;vIWepmcOXGPsYCJQDDcFBKsnOVxzLG52&quot;</span> );

</code></pre></li>
<li><p>
<span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
Откройте <strong>
<span style="font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;">
MainPage.xaml.cs</span></strong>, чтобы показать использование клиента мобильной 
службы для операций вставки, обновления и чтения. <strong>
<span style="font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;">
Продемонстрируйте</span></strong> следующее:</span></p>

<ul>
<li><p>
<span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
Создание маркера для операций в таблице</span></p>

<span class="codelanguage">C#</span><pre><code class="C#"><span style="color:#0000FF">private</span> IMobileServiceTable&lt;TodoItem&gt; todoTable = App.MobileService.GetTable&lt;TodoItem&gt;();

</code></pre></li>
<li><p>
<span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
Выполнение операции вставки</span></p>

<!-- mark:3;-->

<span class="codelanguage">C#</span><pre><code class="C#"><span style="color:#0000FF">private</span> <span style="color:#0000FF">async</span> <span style="color:#0000FF">void</span> InsertTodoItem(TodoItem todoItem)
{
<strong class="markLine">    <span style="color:#0000FF">await</span> todoTable.InsertAsync(todoItem);</strong>
    items.Add(todoItem);                        
}

</code></pre></li>
<li><p>
<span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
Выполнение операции обновления</span></p>

<!-- mark:3 -->

<span class="codelanguage">C#</span><pre><code class="C#"><span style="color:#0000FF">private</span> <span style="color:#0000FF">async</span> <span style="color:#0000FF">void</span> UpdateCheckedTodoItem(TodoItem item)
{
<strong class="markLine">    <span style="color:#0000FF">await</span> todoTable.UpdateAsync(item);</strong>
    items.Remove(item);
}
</code></pre></li>
<li><p>
<span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
Выполнение операции чтения</span></p>

<!-- mark:3-4 -->

<span class="codelanguage">C#</span><pre><code class="C#"><span style="color:#0000FF">private</span> <span style="color:#0000FF">void</span> RefreshTodoItems()
{
<strong class="markLine">    items = todoTable</strong>
<strong class="markLine">         .Where(todoItem =&gt; todoItem.Complete == <span style="color:#0000FF">false</span>)</strong>
         .ToCollectionView();
    ListItems.ItemsSource = items;
}
</code></pre></li>
</ul></li>
<li><p>
<span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
Обратите внимание на использование метода todoTable.DeleteAsync(...).</span></p></li>
</ol>

<p><a name="Demo 2: Adding Push Notifications to your app"></a></p>

<h2 id="Demo_2_Adding_Push_Notifications_to_your_app"><b>
<span lang="RU" style="font-size: 18.0pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: black; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
Демонстрация 2: добавление push-уведомлений в приложение</span></b></h2>

<p>
<span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
В ходе этой демонстрации мы добавим в проект быстрого запуска функцию 
принудительной отправки уведомлений с помощью службы push-уведомлений Windows 
(Windows Push Notification, WNS). После завершения этой процедуры операция 
вставки в мобильной службе вызовет принудительную отправку уведомления в ваше 
приложение. </span> </p>

<p><a name="Register-your-app-for-push-notifications-and-configure-Mobile-Services"></a></p>

<h3 id="Register_your_app_for_push_notifications_and_configure_Mobile_Services">
<b>
<span lang="RU" style="font-size: 13.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
Зарегистрируйте приложение для принудительной отправки уведомлений и настройте 
Windows Azure Mobile Services</span></b></h3>

<ol>
<li><p>
<span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
Перейдите на страницу </span>
<span lang="RU" style="font-size: 12.0pt; font-family: &quot;Times New Roman&quot;,&quot;serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
<a href="http://go.microsoft.com/fwlink/?LinkID=257677&amp;clcid=0x409">
<span style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;">
Windows Push Notifications &amp; Live Connect</span></a></span><span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">; 
при необходимости войдите в учетную запись Microsoft и следуйте инструкции по 
регистрации приложения. <strong>
<span style="font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;">
Пояснение:</span></strong> важно, чтобы CN, который вы использовали в Мастере, 
совпадал с CN в package.appxmanifest.</span></p></li>
<li><p>
<span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
В конце процесса регистрации приложения вам будут предоставлены учетные данные 
WNS. Не закрывайте страницу или запишите <strong>
<span style="font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;">Package 
Name </span></strong>(Название пакета), <strong>
<span style="font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;">Client 
Secret </span></strong>(Секретная информация клиента) и <strong>
<span style="font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;">Package 
SID </span></strong>(ИД безопасности пакета). </span>  </p></li>
<li><p>
<span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
Войдите в </span>
<span lang="RU" style="font-size: 12.0pt; font-family: &quot;Times New Roman&quot;,&quot;serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
<a href="https://manage.windowsazure.com">
<span style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;">
Портал управления Windows Azure</span></a></span><span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">; 
выберите пункт <strong>
<span style="font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;">Mobile 
Services</span></strong>, затем выберите ваше приложение.</span></p></li>
<li><p>
<span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
Выберите вкладку <strong>
<span style="font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;">Push</span></strong> 
(Принудительно отправить); введите <strong>
<span style="font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;">Client 
secret</span></strong>и<strong><span style="font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;">Package 
SID</span></strong>, полученные для WNS ранее; затем нажмите кнопку <strong>
<span style="font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;">Save</span></strong>.</span></p></li>
</ol>

<p><a name="Add-push-notifications-to-the-app"></a></p>

<h3 id="Add_push_notifications_to_the_app"><b>
<span lang="RU" style="font-size: 13.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
Добавление push-уведомлений в приложение</span></b></h3>

<ol>
<li><p>
<span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
В Visual Studio откройте <strong>
<span style="font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;">
package.appxmanifest,</span></strong> выберите вкладку упаковки и скопируйте <em>
<span style="font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;">Package 
Name </span></em>(Имя пакета) из учетных данных WNS, которые вы получили на 
портале Windows Push Notifications &amp; Live Connect. Вставьте эти данные в поле 
Package name в Visual Studio.</span></p></li>
<li><p>
<span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
В package.appxmanifest выберите вкладку <strong>
<span style="font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;">
Application UI</span></strong> (Пользовательский интерфейс приложения) и 
убедитесь, что для параметра <strong>
<span style="font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;">toast 
capable</span></strong> установлено значение Yes (Да). <strong>
<span style="font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;">
Пояснение:</span></strong> если вы хотите отправлять Wide Tiles (Широкие 
плитки), то в поле Wide Logo (Широкая эмблема) необходимо указать широкую плитку 
по умолчанию.</span></p></li>
<li><p>
<span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
Откройте файл <strong>
<span style="font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;">
App.xaml.cs.</span></strong> </span> </p></li>
<li><p>
<span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
Добавьте класс <strong>
<span style="font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;">
Channel.cs</span></strong>, как указано ниже.</span></p>

<span class="codelanguage">C#</span><pre><code class="C#"><span style="color:#0000FF">public</span> <span style="color:#0000FF">class</span> Channel
{
    <span style="color:#0000FF">public</span> <span style="color:#0000FF">int</span> Id { <span style="color:#0000FF">get</span>; <span style="color:#0000FF">set</span>; }
    <span style="color:#0000FF">public</span> <span style="color:#0000FF">string</span> Uri { <span style="color:#0000FF">get</span>; <span style="color:#0000FF">set</span>; }
}

</code></pre>
<blockquote>
<p><strong>
<span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #777777; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
Примечание.</span></strong><span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #777777; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA"> 
Чтобы выполнить эту задачу, можно установить и использовать фрагмент кода <em>
<span style="font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;">
wamschannelclass</span></em>, расположенный в каталоге /Source/ClientSnippets.</span></p>
</blockquote></li>
<li><p>
<span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
Добавьте следующий оператор:</span></p>

<span class="codelanguage">C#</span><pre><code class="C#"><span style="color:#0000FF">using</span> Windows.Networking.PushNotifications;
</code></pre></li>
<li><p>
<span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
Найдите метод OnLaunched и установите для него значение <strong>
<span style="font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;">async</span></strong>, 
как указано ниже.</span></p>

<span class="codelanguage">C#</span><pre><code class="C#"><span style="color:#0000FF">protected</span> <span style="color:#0000FF">async</span> <span style="color:#0000FF">override</span> <span style="color:#0000FF">void</span> OnLaunched(LaunchActivatedEventArgs args)
</code></pre></li>
<li><p>
<span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
Добавьте две строки кода, как указано ниже, чтобы запросить канал уведомления и 
зарегистрировать его в приложении Windows Azure Mobile Services.</span></p>

<span class="codelanguage">C#</span><pre><code class="C#"><span style="color:#0000FF">var</span> ch = <span style="color:#0000FF">await</span> PushNotificationChannelManager.CreatePushNotificationChannelForApplicationAsync();
<span style="color:#0000FF">await</span> MobileService.GetTable&lt;Channel&gt;().InsertAsync(<span style="color:#0000FF">new</span> Channel() { Uri = ch.Uri });
</code></pre>
<blockquote>
<p><strong>
<span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #777777; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
Примечание.</span></strong><span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #777777; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA"> 
Чтобы выполнить эту задачу, можно установить и использовать фрагмент кода <em>
<span style="font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;">
wamschannelrequest</span></em>, расположенный в каталоге /Source/ClientSnippets.</span></p>
</blockquote></li>
</ol>

<p>
<span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
Теперь, когда настройка запроса канала для клиента выполнена и запрос внесен в 
службу Mobile Service, необходимо добавить в нее Channel table (Таблицу каналов) 
и серверный сценарий для принудительной отправки уведомлений.</span></p>

<p><a name="Insert-data-to-receive-notifications"></a></p>

<h3 id="Insert_data_to_receive_notifications"><b>
<span lang="RU" style="font-size: 13.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
Вставка данных для получения уведомлений</span></b></h3>

<p>
<span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
В этом разделе мы добавим таблицу каналов и серверный сценарий для отправки 
push-уведомлений о том, что некто добавляет задачу в список. <strong>
<span style="font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;">
Пояснение:</span></strong> для демонстрационных целей в рамках презентации 
рекомендуется заранее сохранить серверные сценарии, чтобы их можно было 
скопировать и вставить, а затем изучить.</span></p>

<ol>
<li><p>
<span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
Войдите в </span>
<span lang="RU" style="font-size: 12.0pt; font-family: &quot;Times New Roman&quot;,&quot;serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
<a href="https://manage.windowsazure.com">
<span style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;">
Портал управления Windows Azure</span></a></span><span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">; 
выберите пункт <strong>
<span style="font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;">Mobile 
Services</span></strong>, затем выберите ваше приложение.</span></p></li>
<li><p>
<span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
Выберите вкладку <strong>
<span style="font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;">Data.</span></strong></span></p></li>
<li><p>
<span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
В нижней панели инструментов выберите пункт <strong>
<span style="font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;">+ Create 
(+Создать).</span></strong> </span></p></li>
<li><p>
<span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
В поле <strong>
<span style="font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;">Table 
name</span></strong> (Имя таблицы) введите текст <em>
<span style="font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;">Channel 
(Канал)</span></em>, а затем установите флажок.</span></p></li>
<li><p>
<span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
Щелкните новую таблицу <strong>
<span style="font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;">Channel</span></strong> 
и убедитесь, что в ней нет строк данных.</span></p></li>
<li><p>
<span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
Выберите вкладку <strong>
<span style="font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;">Columns</span></strong> 
(Столбцы) и убедитесь, что в ней имеется только один столбец <strong>
<span style="font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;">id</span></strong>, 
созданный автоматически. Один столбец — это минимальное требование к таблице в 
Windows Azure Mobile Services.</span></p>

<p><strong>
<span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
Пояснение:</span></strong><span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA"> 
если в мобильной службе включена динамическая схема, новые столбцы будут 
создаваться автоматически при отправке данных JSON в мобильную службу с помощью 
операций вставки или обновления.</span></p></li>
<li><p>
<span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
Перейдите на вкладку сценария и выберите операцию <strong>
<span style="font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;">Insert</span></strong> 
(Вставить).</span></p></li>
<li><p>
<span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
Замените существующий сценарий указанным ниже. </span>  </p>

<p><strong>
<span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
Пояснение: </span></strong>
<span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
назначение этого сценария — избежать отправки нескольких каналов с одинаковым 
URI всякий раз, когда обработчик OnLaunched выполняется в примере приложения. 
Этот код пригоден для демонстрационного сценария, однако в реальном приложении 
необходимо использовать ID, а не сравнение URI: необходимо заменить позицию 
item.Uri, которая идентифицирует канал. Это нужно сделать потому, что после 
истечения срока предоставления каналов им присваивается новый уникальный URI.</span></p>

<span class="codelanguage">JavaScript</span><pre><code class="JavaScript"><span style="color:#0000FF">function</span> insert(item, user, request) { 
    <span style="color:#0000FF">var</span> channelTable = tables.getTable(&#39;Channel&#39;); 
    channelTable.where({ uri: item.Uri }) 
        .read({ success: insertChannelIfNotFound});     

    <span style="color:#0000FF">function</span> insertChannelIfNotFound(existingChannels) { 
        <span style="color:#0000FF">if</span>(existingChannels.<span style="color:#0000FF">length</span> &gt; 0) { 
                request.respond(200, existingChannels[0]); 
        } <span style="color:#0000FF">else</span> { 
                request.execute(); 
        } 
    } 
}
</code></pre></li>
<li><p>
<span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
Нажмите кнопку <strong>
<span style="font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;">Save</span></strong> 
в нижней панели инструментов. Затем в левой панели навигации выберите таблицу
<strong><span style="font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;">
TodoItem.</span></strong></span></p></li>
<li><p>
<span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
Перейдите на вкладку <strong>
<span style="font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;">Script</span></strong> 
(Сценарий) и выберите операцию <strong>
<span style="font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;">Insert</span></strong>, 
чтобы заменить существующий сценарий указанным ниже; затем рассмотрите его код.</span></p>

<span class="codelanguage">JavaScript</span><pre><code class="JavaScript"><span style="color:#0000FF">function</span> insert(item, user, request) {       
     request.execute({
          success: <span style="color:#0000FF">function</span>(){
                request.respond();
                sendNotifications(item);
          },
          error: <span style="color:#0000FF">function</span>(err){
                request.respond(500, <span style="color:#8B0000">&quot;Error&quot;</span>);
          }
     });
}

<span style="color:#0000FF">function</span> sendNotifications(item){                        
  <span style="color:#0000FF">var</span> channelTable = tables.getTable(&#39;Channel&#39;); 
  channelTable.read({ 
     success: <span style="color:#0000FF">function</span>(channels){
         channels.forEach(<span style="color:#0000FF">function</span>(channel){  

             push.wns.sendToastText04(channel.Uri, {
                  text1: item.text,
                  text2: <span style="color:#8B0000">&quot;text line 2&quot;</span>,
                  text3:  <span style="color:#8B0000">&quot;text line 3&quot;</span>
             }, {
                  success: <span style="color:#0000FF">function</span>(response){                                               
                      console.log(response);
                  },                                   
                  error: <span style="color:#0000FF">function</span>(err){                                               
                        console.error(err);                       
                  }                    
             });
        });
  }        
});    
}
</code></pre>

<p><strong>
<span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
Пояснение:</span></strong><span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA"> 
этот сценарий запускается при выполнении операции вставки в таблицу Todoitem. 
Выбранный нами метод sendNotifications используется для каждого из каналов 
Таблицы каналов; при выполнении итерации отправляется push-уведомление на каждый 
URI канала. Мы продемонстрировали только принудительную отправку уведомления 
Toast (Тост), однако пространство имен push.wns.* позволяет легко отправлять 
уведомления Toast, Tile (Плитка) и Badge (Значок). В этом сценарии мы отправляем 
шаблон ToastText04, состоящий из трех строк текста. Мы не рекомендуем вам 
отправлять уведомления Toast слишком часто при создании собственного приложения; 
лучше использовать их только для отправки важных и критически важных сообщений 
пользователю приложения.</span></p></li>
</ol>

<p>
<span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
Далее мы покажем, как обеспечить безопасность конечных точек службы Mobile 
Service с помощью Live Connect.</span></p>

<p><a name="Demo 3: Adding Auth to Your App and Services"></a></p>

<h2 id="Demo_3_Adding_Auth_to_Your_App_and_Services"><b>
<span lang="RU" style="font-size: 18.0pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: black; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
Демонстрация 3: добавление функции проверки подлинности в приложения и службы</span></b></h2>

<p>
<span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
В ходе этой демонстрации мы покажем, как выполняется проверка подлинности 
пользователей Windows Azure Mobile Services из приложения Windows 8. Мы добавим 
функцию проверки подлинности в проект быстрого запуска с помощью Live Connect. 
После того как Live Connect проведет проверку подлинности, приложение сможет 
работать с вашей мобильной службой.</span></p>

<p><a name="Register-your-app"></a></p>

<h3 id="Register_your_app"><b>
<span lang="RU" style="font-size: 13.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
Регистрация приложения</span></b></h3>

<p>
<span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
Чтобы получить возможность проверки подлинности пользователя, необходимо 
зарегистрировать приложение Windows 8 в Центре разработчиков Live Connect 
Developer Center. Затем нужно зарегистрировать секретную информацию клиента и 
интегрировать Live Connect со службой Mobile Services.</span></p>

<ol>
<li><p>
<span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
Перейдите на страницу </span>
<span lang="RU" style="font-size: 12.0pt; font-family: &quot;Times New Roman&quot;,&quot;serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
<a href="http://go.microsoft.com/fwlink/?LinkID=257677&amp;clcid=0x409">
<span style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;">
Windows Push Notifications &amp; Live Connect</span></a></span><span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">; 
при необходимости войдите в учетную запись Microsoft и следуйте инструкции по 
регистрации приложения.</span></p></li>
<li><p>
<span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
Чтобы включить проверку подлинности, перейдите в панель мониторинга </span>
<span lang="RU" style="font-size: 12.0pt; font-family: &quot;Times New Roman&quot;,&quot;serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
<a href="http://go.microsoft.com/fwlink/?LinkId=262039&amp;clcid=0x409">
<span style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;">
My Apps</span></a></span><span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA"> 
(Мои приложения) Центра разработчиков Live Connect и выберите приложение в 
списке <strong>
<span style="font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;">My 
applications</span></strong> (Мои приложения).</span></p>

<p><strong>
<span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
Примечание.</span></strong><span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA"> 
Для демонстрации этого шага лучше оставить портал Live Connect открытым после 
выполнения сценария создания push-уведомлений, описанного выше.</span></p></li>
<li><p>
<span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
Выберите пункты меню <strong>
<span style="font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;">Edit 
settings</span></strong> (Редактировать параметры), <strong>
<span style="font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;">API 
Settings</span></strong> (Настройки API); запишите значение параметра <strong>
<span style="font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;">Client 
secret</span></strong>.</span></p>

<p>
<span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
Необходимо указать это значение службе Mobile Services, чтобы использовать Live 
Connect для проверки подлинности.</span></p></li>
<li><p>
<span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
В поле <strong>
<span style="font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;">Redirect 
domain</span></strong> (Домен перенаправления) укажите домен вашей мобильной 
службы в формате <strong>
<span style="font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;">
https://service-name.azure-mobile.net/</span></strong>, где <em>
<span style="font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;">
service-name</span></em> — имя вашей мобильной службы; затем нажмите кнопку
<strong><span style="font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;">
Save</span></strong>.</span></p></li>
<li><p>
<span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
Войдите в </span>
<span lang="RU" style="font-size: 12.0pt; font-family: &quot;Times New Roman&quot;,&quot;serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
<a href="https://manage.windowsazure.com">
<span style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;">
Портал управления Windows Azure</span></a></span><span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">; 
выберите пункт <strong>
<span style="font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;">Mobile 
Services</span></strong>, затем выберите ваше приложение.</span></p></li>
<li><p>
<span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
Перейдите на вкладку <strong>
<span style="font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;">Identity</span></strong> 
(Удостоверение); введите значение <strong>
<span style="font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;">Client 
secret</span></strong>, полученное с помощью Live Connect; нажмите кнопку
<strong><span style="font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;">
Save</span></strong>.</span></p></li>
</ol>

<p><a name="Restrict-permissions"></a></p>

<h3 id="Restrict_permissions"><b>
<span lang="RU" style="font-size: 13.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
Ограничение разрешений</span></b></h3>

<ol>
<li><p>
<span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
В Портале управления перейдите на вкладку <strong>
<span style="font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;">Data</span></strong>, 
затем выберите таблицу <strong>
<span style="font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;">TodoItem</span></strong>.</span></p></li>
<li><p>
<span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
Выберите вкладку <strong>
<span style="font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;">
Permissions</span></strong> (Разрешения), установите для всех разрешений 
параметр <strong>
<span style="font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;">Only 
authenticated users</span></strong> (Только прошедшие проверку пользователи), 
затем нажмите кнопку <strong>
<span style="font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;">Save</span></strong>. 
Теперь все операции с таблицей <strong>
<span style="font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;">TodoItem</span></strong> 
потребуют проверки подлинности пользователя. Это позволит упростить сценарии, 
описанные в следующем разделе этого учебного пособия, так как при их выполнении 
доступ анонимным пользователям не предоставляется.</span></p></li>
<li><p>
<span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
Чтобы запустить это приложение на основе быстрого запуска, перейдите в Visual 
Studio 2012 и нажмите клавишу <strong>
<span style="font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;">F5</span></strong>. 
Убедитесь, что отображается исключение с кодом состояния 401 (Недостаточно 
прав). Это произошло потому, что приложение пытается получить доступ к службе 
Mobile Services как не прошедший проверку пользователь, однако теперь таблица
<em><span style="font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;">
TodoItem</span></em> требует проверки подлинности.</span></p></li>
</ol>

<p>
<span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
Теперь мы обновим приложение, добавив в него функцию проверки подлинности с 
помощью Live Connect перед запросом ресурсов мобильной службы.</span></p>

<p><a name="Add-authentication"></a></p>

<h3 id="Add_authentication"><b>
<span lang="RU" style="font-size: 13.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
Добавление проверки подлинности</span></b></h3>

<ol>
<li><p>
<span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
Скачайте и установите </span>
<span lang="RU" style="font-size: 12.0pt; font-family: &quot;Times New Roman&quot;,&quot;serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
<a href="http://go.microsoft.com/fwlink/?LinkId=262253&amp;clcid=0x409">
<span style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;">
пакет Live SDK для Windows</span></a></span><span style="text-underline: single;" class="style1"><span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">.</span></span></p></li>
<li><p>
<span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
В проекте Visual Studio добавьте ссылку на пакет Live SDK.</span></p></li>
<li><p>
<span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
Откройте файл проекта mainpage.xaml.cs и добавьте следующую строку с помощью 
выражений:</span></p>

<span class="codelanguage">C#</span><pre><code class="C#"><span style="color:#0000FF">using</span> Microsoft.Live;
</code></pre></li>
<li><p>
<span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
Добавьте следующий фрагмент кода, который создает переменную для хранения 
текущей сессии Live Connect и метод проверки подлинности:</span></p>

<span class="codelanguage">C#</span><pre><code class="C#"><span style="color:#0000FF">private</span> LiveConnectSession session;
<span style="color:#0000FF">private</span> <span style="color:#0000FF">async</span> System.Threading.Tasks.Task Authenticate()
{
    LiveAuthClient liveIdClient = <span style="color:#0000FF">new</span> LiveAuthClient(<span style="color:#8B0000">&quot;&lt;&lt;TODO Redirect URL here&gt;&gt;&quot;</span>);

    <span style="color:#0000FF">while</span> (session == <span style="color:#0000FF">null</span>)
    {
        <span style="color:#008000">// Force a logout to make it easier to test with multiple Microsoft Accounts </span>
        <span style="color:#0000FF">if</span> (liveIdClient.CanLogout)
            liveIdClient.Logout();

        LiveLoginResult result = <span style="color:#0000FF">await</span> liveIdClient.LoginAsync(<span style="color:#0000FF">new</span>[] { <span style="color:#8B0000">&quot;wl.basic&quot;</span> });
        <span style="color:#0000FF">if</span> (result.Status == LiveConnectSessionStatus.Connected)
        {
            session = result.Session;
            MobileServiceUser loginResult = <span style="color:#0000FF">await</span> App.MobileService.LoginAsync(session.AuthenticationToken);
        }               
    }
}
</code></pre>
<blockquote>
<p><strong>
<span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #777777; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
Примечание.</span></strong><span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #777777; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA"> 
Чтобы выполнить эту задачу, можно установить и использовать фрагмент кода <em>
<span style="font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;">
wamsauthenticate</span></em>, расположенный в каталоге /Source/ClientSnippets.</span></p>
</blockquote></li>
<li><p>
<span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
Обновите строку <em>
<span style="font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;">&lt;&lt; 
INSERT REDIRECT DOMAIN HERE &gt;&gt;</span></em> (УКАЖИТЕ ЗДЕСЬ ДОМЕН ПЕРЕНАПРАВЛЕНИЯ) 
из предыдущего шага. Для этого введите домен перенаправления, указанный при 
настройке приложения в Live Connect, в формате <strong>
<span style="font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;">
https://service-name.azure-mobile.net/</span></strong>.</span></p></li>
<li><p>
<span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
Обновите обработчик событий <strong>
<span style="font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;">
OnNavigatedTo</span></strong>, установив для него значение async; добавьте вызов 
в метод <strong>
<span style="font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;">
Authenticate</span></strong>:</span></p>

<!-- mark:1,3 -->

<span class="codelanguage">C#</span><pre><code class="C#"><strong class="markLine"><span style="color:#0000FF">protected</span> <span style="color:#0000FF">async</span> <span style="color:#0000FF">override</span> <span style="color:#0000FF">void</span> OnNavigatedTo(NavigationEventArgs e)</strong>
{
<strong class="markLine">    <span style="color:#0000FF">await</span> Authenticate();</strong>
    RefreshTodoItems();            
}
</code></pre></li>
<li><p>
<span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
Нажмите клавишу F5, чтобы запустить приложение и войти в Live Connect с помощью 
учетной записи Microsoft.</span></p></li>
</ol>

<p>
<span lang="RU" style="font-size: 10.5pt; font-family: &quot;Helvetica&quot;,&quot;sans-serif&quot;; mso-fareast-font-family: &quot;Times New Roman&quot;; color: #333333; mso-ansi-language: RU; mso-fareast-language: EN-US; mso-bidi-language: AR-SA">
Если вход выполнен успешно, приложение должно работать без ошибок. Вы можете 
посылать запросы службе Mobile Services и обновлять данные.</span></p>

</div>
</body>
</html>
